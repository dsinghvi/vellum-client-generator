When using an LLM, you input a prompt and get back a completion.
However, in order for a prompt to be reusable, you’ll want to
be able to specify certain parts of it dynamically.

That’s where prompt templates come in. Prompt templates contain
the fixed parts of a prompt with placeholders for the parts that
might change from run to run. When you use a prompt template,
you pass in specific values for the placeholders to create
the final prompt that’s sent to the LLM.

Vellum’s Prompt Syntax supports dynamically constructed
prompts via [jinja templating](https://jinja.palletsprojects.com/en/3.1.x/templates/)
and what we call “blocks.”

## Jinja Templating

Jinja is a powerful templating syntax useful for dynamic content.
Most commonly, you’ll use it to reference Prompt Variables.
Below are the most common things you’re likely to want to do,
but you can find jinja’s complete documentation
[here](https://jinja.palletsprojects.com/en/3.1.x/templates/).

### Variables

Reference variables using double-curly-brackets. For example,

<CodeBlock title="Reference Variables">
  ``` You are a {{ personality_type }} AI assistant. ```
</CodeBlock>

<Callout intent="warning">
  Note that all variables are treated as strings!
</Callout>

### Conditionals

Perform conditional logic based on your input variables using if/else statements

<CodeBlock title="Conditional Example">
```
You are a {{ personality_type }} AI assistant.
{% if personality_type == "rude" %}
You end every message with a frowning emoji.
{% else %}
You end every message with a smiling emoji.
{% endif %}
```
</CodeBlock>

### Comments

You can use jinja to leave comments in your prompt that don’t use up any
tokens when compiled and sent to the LLM. For example,

<CodeBlock title="Comment Example">
```
{# This is a comment #}
Hello, world!
```
</CodeBlock>

### JSON Inputs

All Prompt Variables as treated as strings. However, if you want to supply json, you can use this trick to access specific key/value pairs.

For example, say you have a variable called `traits` whose value in a Scenario looked like:

```json
{
  "hair_color": "brown",
  "personality": "happy go lucky"
}
```

Then you can access "happy go lucky with the following:

```
You are a {{ json.loads(traits)["personality"] }} AI assistant.

```

### Casting Variable Types

Vellum currently treats all input variables as strings. However, you may use [jinja filters](https://jinja.palletsprojects.com/en/3.1.x/templates/#list-of-builtin-filters) to convert your variables to specific types and then use them accordingly. For example:

```
You are an AI chat bot working at the registry of motor vehicles.
The person who just stepped up to the counter
{% if age | float > 16 %}
is of legal driving age.
{% else %}
isn't yet old enough to drive.
{% endif %}
```

## Blocks

Vellum uses blocks to separate key pieces of a prompt, such as System/Assistant/User messages of a Chat model (e.g. `gpt-3.5-turbo` or `claude-v1`) or the special `$chat_history` variable.

Blocks are more noticeable when using a Chat model than when using a Text model.

### Chat Model Example

Here’s what a sequence of blocks might look like for a Chat model

![Image](https://vellum-ai.notion.site/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fd638fb25-1fc2-4b3a-adeb-295f56837599%2FScreenshot_5_9_23__6_56_PM.png?table=block&id=d0a3d881-45a2-43fe-954a-d9c77e3641b1&spaceId=71c05e3e-272b-4acf-9889-90a304d95d06&width=2000&userId=&cache=v2)

### Text Model Example

Text models typically use a single block, which might look like this:

### Switching from Chat ↔ Text Models

When switching from a Chat Model to a Text model, blocks are converted as best they can be.

**Chat → Text**

Here’s an example going from Chat to Text.

![Image](https://vellum-ai.notion.site/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc6dca76c-40b2-4f85-b326-1eea8db00ff5%2F2023-05-16_11-24-48.png?table=block&id=dbb5325d-7137-4d6a-97a3-0dc5c863166c&spaceId=71c05e3e-272b-4acf-9889-90a304d95d06&width=2000&userId=&cache=v2)

**Text → Chat**

Here’s an example going from Text to Chat.

![Image](https://vellum-ai.notion.site/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fba26ce4e-9bf2-47dc-b081-72a986d3158c%2F2023-05-16_11-25-26.png?table=block&id=e1073bd7-948d-41d8-83c7-76418d643562&spaceId=71c05e3e-272b-4acf-9889-90a304d95d06&width=2000&userId=&cache=v2)
